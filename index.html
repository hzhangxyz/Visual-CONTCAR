<!DOCTYPE html><link href="//cdn.bootcss.com/bootstrap/4.0.0-alpha.3/css/bootstrap.min.css" rel="stylesheet"><link href="bootstrap.superhero.min.css" rel="stylesheet"><script type="text/javascript" src="//cdn.bootcss.com/three.js/r80/three.min.js"></script><script type="text/javascript" src="OrbitControls.js"></script><div class="container"><div class="row clearfix"><div class="col-md-12 column ui-sortable"><div class="jumbotron"><h1>Visual CONTCAR</h1><p><a class="btn btn-primary btn-large" href="javascript:refreshMeshes(parseContcar());">Visualize It</a> <a class="btn btn-primary btm-large" href="javascript:auto_rotate = !auto_rotate;">Tuggle Rotating</a></p></div></div></div><div class="row clearfix" style="margin-bottom:30px"><div class="col-md-6 column ui-sortable"><textarea id="mainText" type="text" class="form-control" rows="16" placeholder="input CONTCAR here" style="resize:none"></textarea></div><div class="col-md-6 column ui-sortable"><canvas id="mainCanvas" style="width:100%;height=auto"></canvas></div></div><div class="row clearfix"><div class="col-md-12 column ui-sortable"><div id="footer" class="container"><nav class="navbar navbar-default navbar-static-bottom"><div class="navbar-inner navbar-conten"><p class="text-muted credit" style="padding:10px">Powered By <a href="http://getbootstrap.com/" target="to_bootstrap">BootStrap</a> And <a href="http://threejs.org/" target="to_three">THREE.JS</a>. Maintained By <a href="https://github.com/zh19970205/" target="to_github">Hao Zhang</a>.</p></div></nav></div></div></div></div><script type="text/javascript">function init(){document.getElementById("mainCanvas").style.height=h=document.getElementById("mainText").clientHeight,w=document.getElementById("mainCanvas").clientWidth,renderer=new THREE.WebGLRenderer({canvas:document.getElementById("mainCanvas")}),renderer.setClearColor(0),renderer.setSize(w,h),scene=new THREE.Scene,env=new THREE.AmbientLight(16777215,.2),scene.add(env),light=new THREE.PointLight(16777215),light.position.set(10,2,2),scene.add(light),camera=new THREE.PerspectiveCamera(30,w/h),camera.position.set(1,.5,0),camera.lookAt(new THREE.Vector3(0,0,0)),scene.add(camera),data=[["0","0","0","C"],["-0.08958965599331303","0","0","C"],["-0.14672817766504065","-0.07440709334176066","0","N"],["-0.13322970235190246","0.0815023521802388","0.0071418967872009","O"],["0.0509569058602819","0.0749914038187603","0.0152996551374416","O"],["0.0392943758306928","-0.05979094979283295","-0.0120922698220727","H"],["-0.180745657286697","-0.0832049343348821","-0.0585769360424218","H"],["0.0093732447839665","0.1243240386458018","0.0248794636985112","H"],["-0.11518187322055196","-0.1320191749037014","0.0173757452347598","H"],["-0.1870124361887765","0.0709680676053397","0.0424242840363397","H"]],refreshMeshes(data),id=setInterval(render,50),controls=new THREE.OrbitControls(camera,renderer.domElement),controls.update()}function getColor(e){return e.split("").reduce(function(e,n){return e=(e<<5)-e+n.charCodeAt(0),e&e},0)%100/100}function getNewMesh(e){return ans=new THREE.Mesh(new THREE.SphereGeometry(.03,16,16),new THREE.MeshLambertMaterial),ans.material.color.setHSL(1-e,1,.5),ans}function parsePos(e){for(;(temp=e.replace("  "," "))!=e;)e=temp;return e.split(" ").slice(1,4).map(parseFloat).map(function(e){return-.5>e?e+1:e>.5?e-1:e})}function parseContcar(){for(contcar=document.getElementById("mainText").value,pretreat=contcar.split("\n"),atoms=pretreat[5];(temp=atoms.replace("  "," "))!=atoms;)atoms=temp;for(atoms=atoms.split(" ").slice(1),nums=pretreat[6];(temp=nums.replace("  "," "))!=nums;)nums=temp;for(nums=nums.split(" ").slice(1).map(function(e){return parseInt(e)}),sum=nums.reduce(function(e,n){return e+n}),pos=pretreat.slice(9,9+sum).map(parsePos),j=0,i=0;sum>i;i++){for(;0==nums[j];)j++;nums[j]--,pos[i].push(atoms[j])}return pos}function refreshMeshes(e){console.log(e),meshes.forEach(function(e){scene.remove(e)}),meshes=[],e.forEach(function(e){tempColor=getColor(e[3]);var n=getNewMesh(tempColor);n.position.set(e[0],e[1],e[2]),scene.add(n),meshes.push(n)})}function render(){auto_rotate&&meshes.forEach(function(e){e.position.applyEuler(new THREE.Euler(0,.02,0,"XYZ"))}),controls.update(),renderer.render(scene,camera)}var scene=null,camera=null,renderer=null,controls=null,meshes=[],auto_rotate=!0,h=null,w=null;init();</script>
